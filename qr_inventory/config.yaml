name: QR Inventory
version: "0.3.4.1"
slug: qr_inventory
description: "Scan multiple QR codes from an RTSPS/RTSP camera, map them to storage zones, and serve an overlay PNG via HTTP."
arch:
  - amd64
  - aarch64

startup: services
boot: auto
init: false

ports:
  8099/tcp: 8099
ports_description:
  8099/tcp: "Overlay snapshot (/overlay.png or /<overlay_png_name>) + detections (/detections.json)"
webui: "http://[HOST]:[PORT:8099]/"

options:
  camera_mode: rtsps
  rtsp_url: ""
  interval_seconds: 60
  required_consistency: 3
  zones: "{}"
  tls_verify: false
  overlay_png_name: overlay.png

  # Accuracy tuning
  zone_fallback: true
  use_preprocess: true
  roi_padding_px: 60
  roi_scale: 2.0

  # Small-QR boost
  roi_scales: "2.0,3.0,4.0"
  warp_scale: 5.0
  try_invert: true
  adaptive_block_sizes: "21,35,51"
  max_candidates: 160

  # Stream / debug diagnostics
  stream_info_interval_minutes: 0
  debug_metrics: false
  debug_log_every: 1
  debug_max_failed_logs: 20
  debug_save_failed: false
  debug_save_decoded: false
  debug_max_images_per_cycle: 20
  debug_image_format: jpg
  debug_jpeg_quality: 85
  debug_dir: /data/debug

schema:
  camera_mode: list(rtsp|rtsps)
  rtsp_url: str
  interval_seconds: int
  required_consistency: int
  zones: str
  tls_verify: bool
  overlay_png_name: str

  # Accuracy tuning
  zone_fallback: bool
  use_preprocess: bool
  roi_padding_px: int
  roi_scale: float

  # Small-QR boost
  roi_scales: str
  warp_scale: float
  try_invert: bool
  adaptive_block_sizes: str
  max_candidates: int

  # Stream / debug diagnostics
  stream_info_interval_minutes: int
  debug_metrics: bool
  debug_log_every: int
  debug_max_failed_logs: int
  debug_save_failed: bool
  debug_save_decoded: bool
  debug_max_images_per_cycle: int
  debug_image_format: str
  debug_jpeg_quality: int
  debug_dir: str